prior_lambda <- dgamma(lambda, shape = k_prior, scale = theta_prior)
# likelihood
likelihood_pois <- function(lambda) {
prod(dpois(y,lambda))
}
likelihood_pois_val <- map_dbl(lambda, ~likelihood_pois(.x))
sum(prior_lambda * likelihood_pois_val) * delta_lambda
lambda_sim <- rgamma(10000000, shape = k_prior, scale = theta_prior)
prior_pred_pois <- rpois(10000000,lambda_sim)
dprior_pred_pois <- table(prior_pred_pois)/10000000
dprior_pred_pois <- tibble(val = as.numeric(names(dprior_pred_pois)),prob = as.numeric(dprior_pred_pois))
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
delta_lambda <- 0.01
lambda <- seq(0, 1000, delta_lambda)
# Prior distribution discreticized
prior_lambda <- dgamma(lambda, shape = k_prior, scale = theta_prior)
# likelihood
likelihood_pois <- function(lambda) {
prod(dpois(y,lambda))
}
likelihood_pois_val <- map_dbl(lambda, ~likelihood_pois(.x))
sum(prior_lambda * likelihood_pois_val) * delta_lambda
sum(prior_lambda * likelihood_pois_val) * delta_lambda
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
lambda_sim <- rgamma(10000000, shape = k_prior, scale = theta_prior)
prior_pred_pois <- rpois(10000000,lambda_sim)
dprior_pred_pois <- table(prior_pred_pois)/10000000
dprior_pred_pois <- tibble(val = as.numeric(names(dprior_pred_pois)),prob = as.numeric(dprior_pred_pois))
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
max(lambda_sim)
#Observed counts
y <- c(1, 2, 2, 8, 10)
delta_lambda <- 0.01
lambda <- seq(0, 1000, delta_lambda)
# Prior distribution discreticized
prior_lambda <- dgamma(lambda, shape = k_prior, scale = theta_prior)
# likelihood
likelihood_pois <- function(lambda) {
prod(dpois(y,lambda))
}
likelihood_pois_val <- map_dbl(lambda, ~likelihood_pois(.x))
sum(prior_lambda * likelihood_pois_val) * delta_lambda
lambda_sim <- rgamma(10000000, shape = k_prior, scale = theta_prior)
prior_pred_pois <- rpois(10000000,lambda_sim)
dprior_pred_pois <- table(prior_pred_pois)/10000000
dprior_pred_pois <- tibble(val = as.numeric(names(dprior_pred_pois)),prob = as.numeric(dprior_pred_pois))
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]
dprior_pred_pois[dprior_pred_pois$val==2,"prob"]
dprior_pred_pois[dprior_pred_pois$val==8,"prob"]
dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
lambda <- seq(0, 1000, delta_lambda)
lambda <- seq(0.01, 1000, delta_lambda)
# Prior distribution discreticized
prior_lambda <- dgamma(lambda, shape = k_prior, scale = theta_prior)
# likelihood
likelihood_pois <- function(lambda) {
prod(dpois(y,lambda))
}
likelihood_pois_val <- map_dbl(lambda, ~likelihood_pois(.x))
sum(prior_lambda * likelihood_pois_val) * delta_lambda
lambda_sim <- rgamma(10000000, shape = k_prior, scale = theta_prior)
sum(prior_lambda * likelihood_pois_val* delta_lambda)
#### Geometric model
delta_p <- 0.0001
p <- seq(0, 1, delta_p)[-1]
# Prior distribution discreticized
prior_p <- dbeta(p, shape1 = alpha_prior, shape2 = beta_prior)
# likelihood
likelihood_geom <- function(p) {
prod(dgeom(y,p))
}
likelihood_geom_val <- map_dbl(p, ~likelihood_geom(.x))
#
sum(prior_p * likelihood_geom_val) * delta_p
p_sim <- rbeta(1000000, shape1 = alpha_prior, shape2 = beta_prior)
prior_pred_geom <- rgeom(1000000,p_sim)
dprior_pred_geom <- table(prior_pred_geom)/1000000
dprior_pred_geom <- tibble(val = as.numeric(names(dprior_pred_geom)),prob = as.numeric(dprior_pred_geom))
dprior_pred_geom[dprior_pred_geom$val==1,"prob"]*dprior_pred_geom[dprior_pred_geom$val==2,"prob"]*dprior_pred_geom[dprior_pred_geom$val==2,"prob"]*dprior_pred_geom[dprior_pred_geom$val==8,"prob"]*dprior_pred_geom[dprior_pred_geom$val==10,"prob"]
lambda_sim <- rgamma(10000000, shape = k_prior, scale = theta_prior)
prior_pred_pois <- rpois(10000000,lambda_sim)
dprior_pred_pois <- table(prior_pred_pois)/10000000
dprior_pred_pois <- tibble(val = as.numeric(names(dprior_pred_pois)),prob = as.numeric(dprior_pred_pois))
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
table(prior_pred_pois)/10000000
prior_lambda
likelihood_pois_val
dprior_pred_pois
sum(dprior_pred_pois)
sum(dprior_pred_pois$prob)
View(dprior_pred_pois)
#Observed counts
y <- c(1, 2, 2, 8, 10)
delta_lambda <- 0.01
lambda <- seq(0.01, 1000, delta_lambda)
# Prior distribution discreticized
prior_lambda <- dgamma(lambda, shape = k_prior, scale = theta_prior)
# likelihood
likelihood_pois <- function(lambda) {
prod(dpois(y,lambda))
}
likelihood_pois_val <- map_dbl(lambda, ~likelihood_pois(.x))
sum(prior_lambda * likelihood_pois_val* delta_lambda)
2*sum(prior_lambda * likelihood_pois_val* delta_lambda)
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]
lambda_sim <- rgamma(1000000, shape = k_prior, scale = theta_prior)
prior_pred_pois <- rpois(1000000,lambda_sim)
dprior_pred_pois <- table(prior_pred_pois)/1000000
dprior_pred_pois <- tibble(val = as.numeric(names(dprior_pred_pois)),prob = as.numeric(dprior_pred_pois))
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
prior_lambda
sum(prior_lambda * likelihood_pois_val* delta_lambda)
lambda_sim <- rgamma(1000000, shape = k_prior, scale = theta_prior)
prior_pred_pois <- rpois(1000000,lambda_sim)
dprior_pred_pois <- table(prior_pred_pois)/1000000
dprior_pred_pois <- tibble(val = as.numeric(names(dprior_pred_pois)),prob = as.numeric(dprior_pred_pois))
dprior_pred_pois[dprior_pred_pois$val==1,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==2,"prob"]*dprior_pred_pois[dprior_pred_pois$val==8,"prob"]*dprior_pred_pois[dprior_pred_pois$val==10,"prob"]
#### Geometric model
delta_p <- 0.0001
p <- seq(0, 1, delta_p)[-1]
# Prior distribution discreticized
prior_p <- dbeta(p, shape1 = alpha_prior, shape2 = beta_prior)
# likelihood
likelihood_geom <- function(p) {
prod(dgeom(y,p))
}
likelihood_geom_val <- map_dbl(p, ~likelihood_geom(.x))
#
sum(prior_p * likelihood_geom_val) * delta_p
p_sim <- rbeta(1000000, shape1 = alpha_prior, shape2 = beta_prior)
prior_pred_geom <- rgeom(1000000,p_sim)
dprior_pred_geom <- table(prior_pred_geom)/1000000
dprior_pred_geom <- tibble(val = as.numeric(names(dprior_pred_geom)),prob = as.numeric(dprior_pred_geom))
dprior_pred_geom[dprior_pred_geom$val==1,"prob"]*dprior_pred_geom[dprior_pred_geom$val==2,"prob"]*dprior_pred_geom[dprior_pred_geom$val==2,"prob"]*dprior_pred_geom[dprior_pred_geom$val==8,"prob"]*dprior_pred_geom[dprior_pred_geom$val==10,"prob"]
#Observed counts
y <- c(1, 2, 2, 8, 10)
delta_lambda <- 0.01
lambda <- seq(0.01, 1000000, delta_lambda)
library(devtools)
devtools::install_github("rstudio/keras")
install.packages("devtools")
devtools::install_github("rstudio/keras")
library(kesa)
library(keras)
install_keras()
n
library(reticulate)
py_config()
deces_2018 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2018.csv",
";", escape_double = FALSE, trim_ws = TRUE)
library(tidyverse)
library(lubridate)
library(rlang)
deces_2018 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2018.csv",
";", escape_double = FALSE, trim_ws = TRUE)
deces_2018 <- deces_2018 %>% select(datedeces) %>% mutate(death=rep(1,n()),
date = parse_date_time(datedeces,order="ymd"))
deces_2019 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2019.csv",
";", escape_double = FALSE, trim_ws = TRUE)
deces_2019 <- deces_2019 %>% select(datedeces) %>% mutate(death=rep(1,n()),
date = parse_date_time(datedeces,order="ymd"))
daily_deces_2018_2019 <- rbind(deces_2018,deces_2019)
daily_deces_2018_2019 <- daily_deces_2018_2019 %>%
mutate(year=year(date),
week = week(date))
group_cols <- c("year","week")
weekly_deces_2018_2019 <- daily_deces_2018_2019 %>%
group_by(year,week) %>%
summarise(deaths=sum(death))
write_csv(weekly_deces_2018_2019, "weekly_deaths_france_week9_22_years2018_2020_2ndsource.csv")
rm(deces_2018)
rm(deces_2019)
rm(daily_deces_2018_2019)
library(readr)
weekly_deaths_france_week9_22_years2018_2020 <- read_csv("Documents/MESIO/Bayesian Analysis/UPC-Final-Project-Bayesian-Analysis/data_france/weekly_deaths_france_week9_22_years2018_2020.csv")
View(weekly_deaths_france_week9_22_years2018_2020)
weekly_deces_2018_2019 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
View(weekly_deaths_france_week9_22_years2018_2020)
View(weekly_deces_2018_2019)
?pivot_wider
weekly_deces_2018_2019 <- pivot_wider(weekly_deces_2018_2019, id_cols = "week")
weekly_deces_2018_2019 <- pivot_wider(weekly_deces_2018_2019, names_from = "week")
deces_2018 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2018.csv",
";", escape_double = FALSE, trim_ws = TRUE)
deces_2018 <- deces_2018 %>% select(datedeces) %>% mutate(death=rep(1,n()),
date = parse_date_time(datedeces,order="ymd"))
deces_2019 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2019.csv",
";", escape_double = FALSE, trim_ws = TRUE)
deces_2019 <- deces_2019 %>% select(datedeces) %>% mutate(death=rep(1,n()),
date = parse_date_time(datedeces,order="ymd"))
daily_deces_2018_2019 <- rbind(deces_2018,deces_2019)
daily_deces_2018_2019 <- daily_deces_2018_2019 %>%
mutate(year=year(date),
week = week(date))
group_cols <- c("year","week")
weekly_deces_2018_2019 <- daily_deces_2018_2019 %>%
group_by(year,week) %>%
summarise(deaths=sum(death))
rm(deces_2018)
rm(deces_2019)
rm(daily_deces_2018_2019)
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_, names_from = "week",
values_from = c("deaths"))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "week",
values_from = c("deaths"))
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "week",
values_from = c("deaths"))
View(weekly_deces_2018_2019_2)
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "year",
values_from = c("deaths"))
deces_2018 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2018.csv",
";", escape_double = FALSE, trim_ws = TRUE)
View(deces_2018)
deces_2018 <- deces_2018 %>% select(datedeces) %>% mutate(death=rep(1,n()),
date = parse_date_time(datedeces,order="ymd"))
deces_2019 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2019.csv",
";", escape_double = FALSE, trim_ws = TRUE)
deces_2019 <- deces_2019 %>% select(datedeces) %>% mutate(death=rep(1,n()),
date = parse_date_time(datedeces,order="ymd"))
daily_deces_2018_2019 <- rbind(deces_2018,deces_2019)
daily_deces_2018_2019 <- daily_deces_2018_2019 %>%
mutate(year=year(date),
week = week(date))
group_cols <- c("year","week")
weekly_deces_2018_2019 <- daily_deces_2018_2019 %>%
group_by(year,week) %>%
summarise(deaths=sum(death))
sum(weekly_deces_2018_2019$deaths)
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019, names_from = "year",
values_from = c("deaths"))
sum(weekly_deces_2018_2019_2$`2018`)
sum(weekly_deces_2018_2019_2$`2018`,na.rm = TRUE)
sum(weekly_deces_2018_2019_2$`2019`,na.rm = TRUE)
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
setwd("~/Documents/MESIO/Bayesian Analysis/UPC-Final-Project-Bayesian-Analysis/data_france")
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
View(data_daily_2018_2020)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <- data_daily_2018_2020 %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date))
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
View(data_daily_2018_2020)
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
View(data_weekly_2018_2020)
View(weekly_deces_2018_2019_2)
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019, names_from = "year",
values_from = c("deaths"))
View(weekly_deces_2018_2019_2)
daily_deces_2018_2019 <- rbind(deces_2018,deces_2019)
daily_deces_2018_2019 <- daily_deces_2018_2019 %>%
mutate(year=year(date),
week = week(date))
group_cols <- c("year","week")
weekly_deces_2018_2019 <- daily_deces_2018_2019 %>%
group_by(year,week) %>%
summarise(deaths=sum(death))
write_csv(weekly_deces_2018_2019, "weekly_deaths_france_week9_22_years2018_2020_2ndsource.csv")
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019, names_from = "year",
values_from = c("deaths"))
View(weekly_deces_2018_2019_2)
weekly_deces_2018_2019 <- daily_deces_2018_2019 %>%
group_by(year,week) %>%
summarise(deaths=sum(death))
View(weekly_deces_2018_2019)
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019, names_from = "week",
values_from = c("deaths"))
View(weekly_deces_2018_2019_2)
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"))#,week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019, names_from = "week",
values_from = c("deaths"))
View(weekly_deces_2018_2019_2)
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "year",
values_from = c("deaths"))
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"))#,week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "year",
values_from = c("deaths"))
View(weekly_deces_2018_2019_2)
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,22,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "year",
values_from = c("deaths"))
weekly_data_merge<-cbind(data_weekly_2018_2020,weekly_deces_2018_2019_2)
View(weekly_data_merge)
weekly_data_merge <- weekly_data_merge %>%
mutate(ratio_2018 = week_deaths_2018/`2018`)
weekly_data_merge <- weekly_data_merge[,-1] %>%
mutate(ratio_2018 = week_deaths_2018/`2018`)
View(data_weekly_2018_2020)
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <- data_daily_2018_2020 %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date))
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
View(data_weekly_2018_2020)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_com_deaths_2018 = diff(Total_deces_2018),
day_com_deaths_2019 = diff(Total_deces_2019),
day_com_deaths_2020 = diff(Total_deces_2020))%>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_com_deaths_2018 = diff(Total_deces_2018),
day_com_deaths_2019 = diff(Total_deces_2019),
day_com_deaths_2020 = diff(Total_deces_2020))%>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
View(daily_deces_2018_2019)
View(data_daily_2018_2020)
diff(data_daily_2018_2020$Total_deces_2020)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_com_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_com_deaths_2019 = c(data_daily_2018_2019$Total_deces_2019[1],diff(Total_deces_2019)),
day_com_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020)))%>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_com_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_com_deaths_2019 = c(data_daily_2018_2019$Total_deces_2019[1],diff(Total_deces_2019)),
day_com_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020)))%>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_com_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_com_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_com_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020)))%>%
group_by(Date_evenement) %>%
summarise(day_deaths_2018 = sum(Total_deces_2018),
day_deaths_2019 = sum(Total_deces_2019),
day_deaths_2020 = sum(Total_deces_2020)) %>%
ungroup()
data_daily_2018_2020 <- data_daily_2018_2020 %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date))
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
weekly_data_merge<-cbind(data_weekly_2018_2020,weekly_deces_2018_2019_2)
weekly_data_merge <- weekly_data_merge[,-1] %>%
mutate(ratio_2018 = week_deaths_2018/`2018`)
View(weekly_data_merge)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020)))
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020)))
View(daily_deces_2018_2019)
View(data_daily_2018_2020)
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020))) %>%
selec(Date_evenement,day_deaths_2018,day_deaths_2019,day_deaths_2020)
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020))) %>%
select(Date_evenement,day_deaths_2018,day_deaths_2019,day_deaths_2020)
data_daily_2018_2020 <- data_daily_2018_2020 %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date))
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020))) %>%
select(Date_evenement,day_deaths_2018,day_deaths_2019,day_deaths_2020)
data_daily_2018_2020 <- data_daily_2018_2020 %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date))
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
View(data_weekly_2018_2020)
View(data_daily_2018_2020)
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
filter(Zone == "France")
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
filter(Zone == "France") %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date))
data_daily_2018_2020 <- data_daily_2018_2020 %>%
filter(Zone == "France") %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date)) %>%
filter(week < 17)
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
filter(Zone == "France") %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date)) %>%
filter(week < 17) %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020))) %>%
select(Date_evenement,day_deaths_2018,day_deaths_2019,day_deaths_2020)
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
filter(Zone == "France") %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date)) %>%
filter(week < 17) %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020))) %>%
select(Date_evenement,day_deaths_2018,day_deaths_2019,day_deaths_2020)
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
data_daily_2018_2020 <-read_delim("2020-05-07_deces_quotidiens_departement_csv.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data_daily_2018_2020 <- data_daily_2018_2020 %>%
filter(Zone == "France") %>% mutate(date = lubridate::dmy(Date_evenement),
week = lubridate::week(date)) %>%
filter(week < 17) %>%
mutate(day_deaths_2018 = c(data_daily_2018_2020$Total_deces_2018[1],diff(Total_deces_2018)),
day_deaths_2019 = c(data_daily_2018_2020$Total_deces_2019[1],diff(Total_deces_2019)),
day_deaths_2020 = c(data_daily_2018_2020$Total_deces_2020[1],diff(Total_deces_2020))) %>%
select(Date_evenement,week,day_deaths_2018,day_deaths_2019,day_deaths_2020)
write_csv(data_daily_2018_2020,
"daily_deaths_france_week9_22_years2018_2020.csv")
data_weekly_2018_2020 <- data_daily_2018_2020 %>%
group_by(week) %>%
summarise(week_deaths_2018 = sum(day_deaths_2018),
week_deaths_2019 = sum(day_deaths_2019),
week_deaths_2020 = sum(day_deaths_2020))
write_csv(data_weekly_2018_2020,
"weekly_deaths_france_week9_22_years2018_2020.csv")
weekly_deces_2018_2019_2 <- weekly_deces_2018_2019 %>% filter(year %in% c("2018","2019"),week %in% seq(9,16,1))
weekly_deces_2018_2019_2 <- pivot_wider(weekly_deces_2018_2019_2, names_from = "year",
values_from = c("deaths"))
weekly_data_merge<-cbind(data_weekly_2018_2020,weekly_deces_2018_2019_2)
weekly_data_merge <- weekly_data_merge[,-1] %>%
mutate(ratio_2018 = week_deaths_2018/`2018`)
write_csv(weekly_data_merge, "merged_data_weekly.csv")
View(data_daily_2018_2020)
deces_2009 <- read_delim("~/Downloads/deces-2010-2018-csv/deces-2009.csv",
";", escape_double = FALSE, trim_ws = TRUE)
